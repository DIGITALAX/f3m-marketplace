{"ast":null,"code":"var _jsxFileName = \"/Volumes/Data/Work/Digitalax/f3m-marketplace/src/components/image-card/index.js\";\nvar __jsx = React.createElement;\nimport { openBuynowModal, openConnectMetamaskModal, openPlaceBidModal, openSwitchNetworkModal } from \"@actions/modals.actions\";\nimport NewButton from \"@components/buttons/newbutton\";\nimport Link from \"next/link\";\nimport { getAccount } from \"@selectors/user.selectors\";\nimport LazyLoad from \"react-lazyload\";\nimport { useRouter } from \"next/router\";\nimport React, { useState, useRef, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getRarityId, reviseUrl } from \"@utils/helpers\";\nimport { getChainId } from \"@selectors/global.selectors\";\nimport Button from \"@components/buttons/button\";\nimport styles from \"./styles.module.scss\";\n\nconst ImageCard = ({\n  mainImage,\n  mainImageType,\n  data,\n  showDesigner = false,\n  showCollectionName = false,\n  showRarity = false,\n  showButton = true,\n  showMute = false,\n  showZoom = false,\n  keepRatio = false,\n  imgUrl = null,\n  offerCount = null,\n  reservePrice = null,\n  price,\n  disable = false,\n  withLink = false,\n  imgLink = null,\n  isAuction = false,\n  v1 = false,\n  borderType = \"blue\"\n}) => {\n  var _data$model, _data$model2, _data$model3;\n\n  const router = useRouter();\n  const account = useSelector(getAccount);\n  const chainId = useSelector(getChainId);\n  const {\n    asPath\n  } = router;\n  const dispatch = useDispatch();\n  const {\n    0: zoomMedia,\n    1: setZoomMedia\n  } = useState(false);\n  const videoTagRef = useRef();\n  const {\n    0: hasAudio,\n    1: setHasAudio\n  } = useState(false);\n  const {\n    0: videoMuted,\n    1: setVideoMuted\n  } = useState(true);\n  const {\n    0: defaultMainImage,\n    1: setDefaultMainImage\n  } = useState(mainImage);\n  const {\n    0: defaultMainImageType,\n    1: setDefaultMainImageType\n  } = useState(mainImageType);\n\n  function getAudio(video) {\n    return video.mozHasAudio || Boolean(video.webkitAudioDecodedByteCount) || Boolean(video.audioTracks && video.audioTracks.length);\n  }\n\n  const onBuyNow = () => {\n    if (!router.asPath.includes(\"product\")) {\n      console.log(\"router.asPath: \", router.asPath);\n      router.push(`/product/${v1 ? `v1-${data === null || data === void 0 ? void 0 : data.id}` : data === null || data === void 0 ? void 0 : data.id}/${getRarityId(data.rarity)}/${isAuction ? 1 : 0}`).then(() => window.scrollTo(0, 0));\n    } else {\n      if (account) {\n        if (chainId === \"0x89\") {\n          if (!isAuction) {\n            dispatch(openBuynowModal({\n              id: data.id,\n              priceEth: price\n            }));\n          } else {\n            dispatch(openPlaceBidModal({\n              id: data.id,\n              priceEth: price\n            }));\n          }\n        } else {\n          dispatch(openSwitchNetworkModal());\n        }\n      } else {\n        dispatch(openConnectMetamaskModal());\n      }\n    }\n  };\n\n  const onClickZoomOut = () => {\n    setZoomMedia(true);\n  };\n\n  const onClickZoomIn = () => {\n    setZoomMedia(false);\n  };\n\n  useEffect(() => {\n    if (!mainImage) {\n      var _data$garment, _data$garment2, _data$garment3, _data$garment4;\n\n      setDefaultMainImage((data === null || data === void 0 ? void 0 : (_data$garment = data.garment) === null || _data$garment === void 0 ? void 0 : _data$garment.animation) || (data === null || data === void 0 ? void 0 : data.animation) || (data === null || data === void 0 ? void 0 : (_data$garment2 = data.garment) === null || _data$garment2 === void 0 ? void 0 : _data$garment2.image) || (data === null || data === void 0 ? void 0 : data.image));\n      if (data !== null && data !== void 0 && (_data$garment3 = data.garment) !== null && _data$garment3 !== void 0 && _data$garment3.animation || data !== null && data !== void 0 && data.animation) setDefaultMainImageType(1);else if (data !== null && data !== void 0 && (_data$garment4 = data.garment) !== null && _data$garment4 !== void 0 && _data$garment4.image || data !== null && data !== void 0 && data.image) setDefaultMainImageType(2);\n    }\n  }, [data]);\n\n  const onClickMute = () => {\n    videoTagRef.current.pause();\n    setVideoMuted(!videoMuted);\n    videoTagRef.current.play();\n  };\n\n  useEffect(() => {\n    if (mainImageType === 1 && videoTagRef.current) {\n      videoTagRef.current.load();\n    }\n  }, [mainImageType, mainImage]);\n\n  const renderImage = () => {\n    var _data$garment5;\n\n    return __jsx(\"div\", {\n      className: [styles.bodyWrapper, borderType === \"blue\" ? styles.blue : \"\", borderType === \"none\" ? styles.none : \"\"].join(\" \"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 7\n      }\n    }, // Rarity\n    showRarity ? __jsx(\"div\", {\n      className: styles.rarity,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 13\n      }\n    }, \" \", (data === null || data === void 0 ? void 0 : data.rarity) || (data === null || data === void 0 ? void 0 : (_data$garment5 = data.garment) === null || _data$garment5 === void 0 ? void 0 : _data$garment5.rarity), \" \") : null, data ? __jsx(\"div\", {\n      className: [zoomMedia ? styles.zoomWrapper : styles.mediaWrapper, keepRatio ? styles.keepRatio : ''].join(' '),\n      onClick: () => onClickZoomIn(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 13\n      }\n    }, // Video\n    (mainImageType || defaultMainImageType) === 1 ? __jsx(LazyLoad, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 21\n      }\n    }, __jsx(\"video\", {\n      key: data.id,\n      autoPlay: true,\n      muted: videoMuted,\n      loop: true,\n      className: styles.video,\n      ref: videoTagRef,\n      preload: \"auto\",\n      onLoadedData: () => {\n        if (!asPath.includes(\"product\")) return; // console.log('videoTagRef: ', videoTagRef.current)\n\n        var video = videoTagRef.current; // console.log('video: ', video)\n\n        if (getAudio(video)) {\n          // console.log('video has audio')\n          setHasAudio(true);\n        } else {\n          setHasAudio(false); // console.log(`video doesn't have audio`)\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 23\n      }\n    }, __jsx(\"source\", {\n      src: reviseUrl(mainImage || defaultMainImage),\n      type: \"video/mp4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 25\n      }\n    }))) : mainImageType === 2 || defaultMainImageType === 2 ? __jsx(\"img\", {\n      src: reviseUrl(mainImage || defaultMainImage),\n      className: styles.image,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 21\n      }\n    }) : null, hasAudio && zoomMedia && showMute && __jsx(Button, {\n      className: styles.muteButton,\n      onClick: e => {\n        e.stopPropagation();\n        onClickMute();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 17\n      }\n    }, videoMuted ? __jsx(\"img\", {\n      src: \"/images/audio-off.png\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 21\n      }\n    }) : __jsx(\"img\", {\n      src: \"/images/audio-on.png\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 21\n      }\n    }))) : null, asPath.includes(\"product/\") && __jsx(Button, {\n      className: styles.zoomButton,\n      onClick: () => onClickZoomOut(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 11\n      }\n    }, __jsx(\"img\", {\n      src: \"/images/zoom_btn.png\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 13\n      }\n    })), hasAudio && (mainImageType === 1 || defaultMainImageType === 1) && showMute && __jsx(Button, {\n      className: styles.muteButton,\n      onClick: () => onClickMute(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 11\n      }\n    }, videoMuted ? __jsx(\"img\", {\n      src: \"/images/audio-off.png\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 15\n      }\n    }) : __jsx(\"img\", {\n      src: \"/images/audio-on.png\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 15\n      }\n    })), !!reservePrice && __jsx(\"div\", {\n      className: styles.reservePrice,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 11\n      }\n    }, __jsx(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 13\n      }\n    }, reservePrice), __jsx(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 13\n      }\n    }, \" Reserve Price \")), imgUrl ? __jsx(\"img\", {\n      src: reviseUrl(imgUrl),\n      className: styles.image,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 11\n      }\n    }) : null, showButton && __jsx(\"div\", {\n      className: styles.buyNow,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 11\n      }\n    }, __jsx(NewButton, {\n      text: disable ? \"Sold Out\" : isAuction ? \"Place A Bid\" : \"Buy Now\",\n      onClick: onBuyNow,\n      disable: disable,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 13\n      }\n    })), !!offerCount && __jsx(\"div\", {\n      className: styles.offerCount,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 11\n      }\n    }, __jsx(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 13\n      }\n    }, offerCount), \" Offers\"));\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: styles.imageCardWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 7\n    }\n  }, showCollectionName ? __jsx(\"div\", {\n    className: styles.collectionName,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 11\n    }\n  }, data !== null && data !== void 0 && data.garment ? data.garment.name : data.name) : null, showDesigner ? __jsx(\"a\", {\n    href: `https://models.digitalax.xyz/models/${data === null || data === void 0 ? void 0 : (_data$model = data.model) === null || _data$model === void 0 ? void 0 : _data$model.name}`,\n    target: \"_blank\",\n    className: styles.designerLink,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    className: styles.designerWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 13\n    }\n  }, __jsx(\"img\", {\n    src: data === null || data === void 0 ? void 0 : (_data$model2 = data.model) === null || _data$model2 === void 0 ? void 0 : _data$model2.image,\n    className: styles.photo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 15\n    }\n  }), __jsx(\"div\", {\n    className: styles.name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 15\n    }\n  }, data === null || data === void 0 ? void 0 : (_data$model3 = data.model) === null || _data$model3 === void 0 ? void 0 : _data$model3.name, \" \"))) : null, withLink ? __jsx(Link, {\n    href: imgLink ? imgLink : `/product/${data === null || data === void 0 ? void 0 : data.id}/${getRarityId(data === null || data === void 0 ? void 0 : data.rarity)}/${isAuction ? 1 : 0}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 11\n    }\n  }, __jsx(\"a\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 13\n    }\n  }, renderImage())) : renderImage()));\n};\n\nexport default ImageCard;","map":{"version":3,"sources":["/Volumes/Data/Work/Digitalax/f3m-marketplace/src/components/image-card/index.js"],"names":["openBuynowModal","openConnectMetamaskModal","openPlaceBidModal","openSwitchNetworkModal","NewButton","Link","getAccount","LazyLoad","useRouter","React","useState","useRef","useEffect","useDispatch","useSelector","getRarityId","reviseUrl","getChainId","Button","styles","ImageCard","mainImage","mainImageType","data","showDesigner","showCollectionName","showRarity","showButton","showMute","showZoom","keepRatio","imgUrl","offerCount","reservePrice","price","disable","withLink","imgLink","isAuction","v1","borderType","router","account","chainId","asPath","dispatch","zoomMedia","setZoomMedia","videoTagRef","hasAudio","setHasAudio","videoMuted","setVideoMuted","defaultMainImage","setDefaultMainImage","defaultMainImageType","setDefaultMainImageType","getAudio","video","mozHasAudio","Boolean","webkitAudioDecodedByteCount","audioTracks","length","onBuyNow","includes","console","log","push","id","rarity","then","window","scrollTo","priceEth","onClickZoomOut","onClickZoomIn","garment","animation","image","onClickMute","current","pause","play","load","renderImage","bodyWrapper","blue","none","join","zoomWrapper","mediaWrapper","muteButton","e","stopPropagation","zoomButton","buyNow","imageCardWrapper","collectionName","name","model","designerLink","designerWrapper","photo"],"mappings":"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","sourcesContent":["import {\n  openBuynowModal,\n  openConnectMetamaskModal,\n  openPlaceBidModal,\n  openSwitchNetworkModal,\n} from \"@actions/modals.actions\";\nimport NewButton from \"@components/buttons/newbutton\";\nimport Link from \"next/link\";\nimport { getAccount } from \"@selectors/user.selectors\";\nimport LazyLoad from \"react-lazyload\";\nimport { useRouter } from \"next/router\";\nimport React, { useState, useRef, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getRarityId, reviseUrl } from \"@utils/helpers\";\nimport { getChainId } from \"@selectors/global.selectors\";\nimport Button from \"@components/buttons/button\";\nimport styles from \"./styles.module.scss\";\n\nconst ImageCard = ({\n  mainImage,\n  mainImageType,\n  data,\n  showDesigner = false,\n  showCollectionName = false,\n  showRarity = false,\n  showButton = true,\n  showMute = false,\n  showZoom = false,\n  keepRatio = false,\n  imgUrl = null,\n  offerCount = null,\n  reservePrice = null,\n  price,\n  disable = false,\n  withLink = false,\n  imgLink = null,\n  isAuction = false,\n  v1 = false,\n  borderType = \"blue\",\n}) => {\n  const router = useRouter();\n  const account = useSelector(getAccount);\n  const chainId = useSelector(getChainId);\n  const { asPath } = router;\n  const dispatch = useDispatch();\n  const [zoomMedia, setZoomMedia] = useState(false);\n  const videoTagRef = useRef();\n  const [hasAudio, setHasAudio] = useState(false);\n  const [videoMuted, setVideoMuted] = useState(true);\n  const [defaultMainImage, setDefaultMainImage] = useState(mainImage);\n  const [defaultMainImageType, setDefaultMainImageType] =\n    useState(mainImageType);\n\n  function getAudio(video) {\n    return (\n      video.mozHasAudio ||\n      Boolean(video.webkitAudioDecodedByteCount) ||\n      Boolean(video.audioTracks && video.audioTracks.length)\n    );\n  }\n\n  const onBuyNow = () => {\n    if (!router.asPath.includes(\"product\")) {\n      console.log(\"router.asPath: \", router.asPath);\n      router\n        .push(\n          `/product/${v1 ? `v1-${data?.id}` : data?.id}/${getRarityId(\n            data.rarity\n          )}/${isAuction ? 1 : 0}`\n        )\n        .then(() => window.scrollTo(0, 0));\n    } else {\n      if (account) {\n        if (chainId === \"0x89\") {\n          if (!isAuction) {\n            dispatch(\n              openBuynowModal({\n                id: data.id,\n                priceEth: price,\n              })\n            );\n          } else {\n            dispatch(\n              openPlaceBidModal({\n                id: data.id,\n                priceEth: price,\n              })\n            );\n          }\n        } else {\n          dispatch(openSwitchNetworkModal());\n        }\n      } else {\n        dispatch(openConnectMetamaskModal());\n      }\n    }\n  };\n\n  const onClickZoomOut = () => {\n    setZoomMedia(true);\n  };\n\n  const onClickZoomIn = () => {\n    setZoomMedia(false);\n  };\n\n  useEffect(() => {\n    if (!mainImage) {\n      setDefaultMainImage(\n        data?.garment?.animation ||\n          data?.animation ||\n          data?.garment?.image ||\n          data?.image\n      );\n      if (data?.garment?.animation || data?.animation)\n        setDefaultMainImageType(1);\n      else if (data?.garment?.image || data?.image) setDefaultMainImageType(2);\n    }\n  }, [data]);\n\n  const onClickMute = () => {\n    videoTagRef.current.pause();\n    setVideoMuted(!videoMuted);\n    videoTagRef.current.play();\n  };\n\n  useEffect(() => {\n    if (mainImageType === 1 && videoTagRef.current) {\n      videoTagRef.current.load();\n    }\n  }, [mainImageType, mainImage]);\n\n  const renderImage = () => {\n    return (\n      <div\n        className={[\n          styles.bodyWrapper,\n          borderType === \"blue\" ? styles.blue : \"\",\n          borderType === \"none\" ? styles.none : \"\",\n        ].join(\" \")}\n      >\n        {\n          // Rarity\n          showRarity ? (\n            <div className={styles.rarity}>\n              {\" \"}\n              {data?.rarity || data?.garment?.rarity}{\" \"}\n            </div>\n          ) \n          : null\n        }\n        {\n          data\n          ? (\n            <div\n              className={[zoomMedia ? styles.zoomWrapper : styles.mediaWrapper, keepRatio ? styles.keepRatio : ''].join(' ')}\n              onClick={() => onClickZoomIn()}\n            >\n              {\n                // Video\n                (mainImageType || defaultMainImageType) === 1\n                ? (\n                    <LazyLoad>\n                      <video\n                        key={data.id}\n                        autoPlay\n                        muted={videoMuted}\n                        loop\n                        className={styles.video}\n                        ref={videoTagRef}\n                        preload={\"auto\"}\n                        onLoadedData={() => {\n                          if (!asPath.includes(\"product\")) return;\n                          // console.log('videoTagRef: ', videoTagRef.current)\n                          var video = videoTagRef.current;\n                          // console.log('video: ', video)\n                          if (getAudio(video)) {\n                            // console.log('video has audio')\n                            setHasAudio(true);\n                          } else {\n                            setHasAudio(false);\n                            // console.log(`video doesn't have audio`)\n                          }\n                        }}\n                      >\n                        <source\n                          src={reviseUrl(mainImage || defaultMainImage)}\n                          type=\"video/mp4\"\n                        />\n                      </video>\n                    </LazyLoad>\n                  )\n                  // Image\n                : mainImageType === 2 || defaultMainImageType === 2\n                  ? (\n                    <img\n                      src={reviseUrl(mainImage || defaultMainImage)}\n                      className={styles.image}\n                    />\n                  ) \n                  : null\n              }\n              {hasAudio && zoomMedia && showMute && (\n                <Button\n                  className={styles.muteButton}\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    onClickMute();\n                  }}\n                >\n                  {videoMuted ? (\n                    <img src=\"/images/audio-off.png\" />\n                  ) : (\n                    <img src=\"/images/audio-on.png\" />\n                  )}\n                </Button>\n              )}\n            </div>\n            )\n          : null}\n        {asPath.includes(\"product/\") && (\n          <Button\n            className={styles.zoomButton}\n            onClick={() => onClickZoomOut()}\n          >\n            <img src=\"/images/zoom_btn.png\" />\n          </Button>\n        )}\n        {hasAudio && (mainImageType === 1 || defaultMainImageType === 1) && showMute && (\n          <Button className={styles.muteButton} onClick={() => onClickMute()}>\n            {videoMuted ? (\n              <img src=\"/images/audio-off.png\" />\n            ) : (\n              <img src=\"/images/audio-on.png\" />\n            )}\n          </Button>\n        )}\n        {!!reservePrice && (\n          <div className={styles.reservePrice}>\n            <span>{reservePrice}</span>\n            <p> Reserve Price </p>\n          </div>\n        )}\n        {imgUrl ? (\n          <img src={reviseUrl(imgUrl)} className={styles.image} />\n        ) : null}\n        {showButton && (\n          <div className={styles.buyNow}>\n            <NewButton\n              text={\n                disable ? \"Sold Out\" : isAuction ? \"Place A Bid\" : \"Buy Now\"\n              }\n              onClick={onBuyNow}\n              disable={disable}\n            />\n          </div>\n        )}\n        {!!offerCount && (\n          <div className={styles.offerCount}>\n            <span>{offerCount}</span> Offers\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  return (\n    <>\n      <div className={styles.imageCardWrapper}>\n        {showCollectionName ? (\n          <div className={styles.collectionName}>\n            {data?.garment ? data.garment.name : data.name}\n          </div>\n        ) : null}\n        {showDesigner ? (\n          <a\n            href={`https://models.digitalax.xyz/models/${data?.model?.name}`}\n            target=\"_blank\"\n            className={styles.designerLink}\n          >\n            <div className={styles.designerWrapper}>\n              <img src={data?.model?.image} className={styles.photo} />\n              <div className={styles.name}>{data?.model?.name} </div>\n            </div>\n          </a>\n        ) : null}\n        {withLink ? (\n          <Link\n            href={\n              imgLink\n                ? imgLink\n                : `/product/${data?.id}/${getRarityId(data?.rarity)}/${\n                    isAuction ? 1 : 0\n                  }`\n            }\n          >\n            <a>{renderImage()}</a>\n          </Link>\n        ) : (\n          renderImage()\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default ImageCard;\n"]},"metadata":{},"sourceType":"module"}